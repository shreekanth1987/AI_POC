{"producer": "https://github.com/OpenLineage/OpenLineage/blob/main/integration/python", "schemaURL": "https://openlineage.io/spec/1-0-2/OpenLineage.json", "eventTime": "2023-09-28T10:00:00.000Z", "run": {"runId": "d46e465b-d358-4d32-83d4-df661ff6f4dd", "facets": {"nominalTime": {"_producer": "my-airflow-scheduler", "_schemaURL": "https://openlineage.io/spec/facets/1-0-0/NominalTimeRunFacet.json", "nominalStartTime": "2023-09-28T09:00:00Z", "nominalEndTime": "2023-09-28T10:00:00Z"}}}, "job": {"namespace": "example-python-app", "name": "etl_booking_currency_conversion", "facets": {"sourceCodeLocation": {"_producer": "https://github.com/OpenLineage/OpenLineage/blob/main/integration/python", "_schemaURL": "https://openlineage.io/spec/facets/1-0-0/SourceCodeLocationJobFacet.json", "type": "python", "url": "file://path/to/your/script.py"}}}, "inputs": [{"namespace": "file://local-filesystem", "name": "bronze_daily_bookings.csv", "facets": {"dataSource": {"_producer": "https://github.com/OpenLineage/OpenLineage/blob/main/integration/python", "_schemaURL": "https://openlineage.io/spec/facets/1-0-0/DatasourceDatasetFacet.json", "name": "bronze_daily_bookings.csv", "uri": "file://local-filesystem/bronze_daily_bookings.csv"}, "schema": {"_producer": "https://github.com/OpenLineage/OpenLineage/blob/main/integration/python", "_schemaURL": "https://openlineage.io/spec/facets/1-0-0/SchemaDatasetFacet.json", "fields": [{"name": "booking_reference_id", "type": "string"}, {"name": "customer_id", "type": "string"}, {"name": "flight_number_raw", "type": "string"}, {"name": "booking_date_time_raw", "type": "string"}, {"name": "fare_amount_local", "type": "string"}, {"name": "currency_code_raw", "type": "string"}]}}}], "outputs": [{"namespace": "file://local-filesystem", "name": "silver_daily_bookings.csv", "facets": {"dataSource": {"_producer": "https://github.com/OpenLineage/OpenLineage/blob/main/integration/python", "_schemaURL": "https://openlineage.io/spec/facets/1-0-0/DatasourceDatasetFacet.json", "name": "silver_daily_bookings.csv", "uri": "file://local-filesystem/silver_daily_bookings.csv"}, "schema": {"_producer": "https://github.com/OpenLineage/OpenLineage/blob/main/integration/python", "_schemaURL": "https://openlineage.io/spec/facets/1-0-0/SchemaDatasetFacet.json", "fields": [{"name": "booking_key", "type": "string"}, {"name": "customer_id", "type": "string"}, {"name": "flight_number", "type": "string"}, {"name": "booking_date_utc", "type": "datetime"}, {"name": "fare_amount_local", "type": "decimal"}, {"name": "currency_code", "type": "string"}, {"name": "fare_amount_usd", "type": "decimal"}, {"name": "load_timestamp", "type": "datetime"}]}, "columnLineage": {"_producer": "https://github.com/OpenLineage/OpenLineage/blob/main/integration/python", "_schemaURL": "https://openlineage.io/spec/facets/1-0-0/ColumnLineageDatasetFacet.json", "fields": {"booking_key": {"inputFields": [{"namespace": "file://local-filesystem", "name": "bronze_daily_bookings.csv", "field": "booking_reference_id"}], "transformationDescription": "RENAME", "transformationType": "PYTHON"}, "customer_id": {"inputFields": [{"namespace": "file://local-filesystem", "name": "bronze_daily_bookings.csv", "field": "customer_id"}], "transformationDescription": "DIRECT", "transformationType": "PYTHON"}, "flight_number": {"inputFields": [{"namespace": "file://local-filesystem", "name": "bronze_daily_bookings.csv", "field": "flight_number_raw"}], "transformationDescription": "str.strip().str.upper()", "transformationType": "PYTHON"}, "booking_date_utc": {"inputFields": [{"namespace": "file://local-filesystem", "name": "bronze_daily_bookings.csv", "field": "booking_date_time_raw"}], "transformationDescription": "pd.to_datetime().dt.strftime('%Y-%m-%d %H:%M:%S')", "transformationType": "PYTHON"}, "fare_amount_local": {"inputFields": [{"namespace": "file://local-filesystem", "name": "bronze_daily_bookings.csv", "field": "fare_amount_local"}], "transformationDescription": "pd.to_numeric()", "transformationType": "PYTHON"}, "currency_code": {"inputFields": [{"namespace": "file://local-filesystem", "name": "bronze_daily_bookings.csv", "field": "currency_code_raw"}], "transformationDescription": "str.strip().str.upper().str.replace('YEN', 'JPY')", "transformationType": "PYTHON"}, "fare_amount_usd": {"inputFields": [{"namespace": "file://local-filesystem", "name": "bronze_daily_bookings.csv", "field": "fare_amount_local"}, {"namespace": "file://local-filesystem", "name": "bronze_daily_bookings.csv", "field": "currency_code_raw"}], "transformationDescription": "Multiplication with exchange rate based on currency code", "transformationType": "PYTHON"}, "load_timestamp": {"inputFields": [], "transformationDescription": "datetime.now()", "transformationType": "PYTHON"}}}}}]}