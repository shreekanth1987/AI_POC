{"producer": "https://github.com/OpenLineage/OpenLineage/tree/main/integration/python", "schemaURL": "https://openlineage.io/spec/1-0-2/OpenLineage.json", "eventTime": "2023-09-01T14:30:00.000Z", "eventType": "COMPLETE", "run": {"runId": "d46e465b-d358-4d32-83d4-df660ff614dd", "facets": {"nominalTime": {"_producer": "my-airflow-scheduler", "_schemaURL": "https://openlineage.io/spec/facets/1-0-0/NominalTimeRunFacet.json", "nominalStartTime": "2023-09-01T14:29:00.000Z", "nominalEndTime": "2023-09-01T14:30:00.000Z"}, "documentation": {"_producer": "https://github.com/OpenLineage/OpenLineage/tree/main/integration/python", "_schemaURL": "https://openlineage.io/spec/facets/1-0-0/DocumentationJobFacet.json", "description": "ETL Job 2: Converts booking fares to a standard USD rate."}}}, "job": {"namespace": "example-project", "name": "etl_booking_currency_conversion", "facets": {}}, "inputs": [{"namespace": "file://my-local-filesystem", "name": "/data/bronze_daily_bookings.csv", "facets": {"schema": {"_producer": "python-script-parser", "_schemaURL": "https://openlineage.io/spec/facets/1-0-0/SchemaDatasetFacet.json", "fields": [{"name": "booking_reference_id", "type": "string"}, {"name": "customer_id", "type": "integer"}, {"name": "flight_number_raw", "type": "string"}, {"name": "booking_date_time_raw", "type": "string"}, {"name": "fare_amount_local", "type": "string"}, {"name": "currency_code_raw", "type": "string"}]}}}], "outputs": [{"namespace": "file://my-local-filesystem", "name": "/data/silver_daily_bookings.csv", "facets": {"schema": {"_producer": "python-script-parser", "_schemaURL": "https://openlineage.io/spec/facets/1-0-0/SchemaDatasetFacet.json", "fields": [{"name": "booking_key", "type": "string"}, {"name": "customer_id", "type": "integer"}, {"name": "flight_number", "type": "string"}, {"name": "booking_date_utc", "type": "datetime"}, {"name": "fare_amount_local", "type": "float"}, {"name": "currency_code", "type": "string"}, {"name": "fare_amount_usd", "type": "float"}, {"name": "load_timestamp", "type": "datetime"}]}, "columnLevelLineage": {"_producer": "python-script-parser", "_schemaURL": "https://openlineage.io/spec/facets/1-0-0/ColumnLevelLineageDatasetFacet.json", "fields": {"booking_key": {"inputFields": [{"namespace": "file://my-local-filesystem", "name": "/data/bronze_daily_bookings.csv", "field": "booking_reference_id"}], "transformationDescription": "Direct copy"}, "customer_id": {"inputFields": [{"namespace": "file://my-local-filesystem", "name": "/data/bronze_daily_bookings.csv", "field": "customer_id"}], "transformationDescription": "Direct copy"}, "flight_number": {"inputFields": [{"namespace": "file://my-local-filesystem", "name": "/data/bronze_daily_bookings.csv", "field": "flight_number_raw"}], "transformationDescription": "str.strip().str.upper()"}, "booking_date_utc": {"inputFields": [{"namespace": "file://my-local-filesystem", "name": "/data/bronze_daily_bookings.csv", "field": "booking_date_time_raw"}], "transformationDescription": "pd.to_datetime().dt.strftime('%Y-%m-%d %H:%M:%S')"}, "fare_amount_local": {"inputFields": [{"namespace": "file://my-local-filesystem", "name": "/data/bronze_daily_bookings.csv", "field": "fare_amount_local"}], "transformationDescription": "pd.to_numeric(errors='coerce')"}, "currency_code": {"inputFields": [{"namespace": "file://my-local-filesystem", "name": "/data/bronze_daily_bookings.csv", "field": "currency_code_raw"}], "transformationDescription": "str.strip().str.upper().str.replace('YEN', 'JPY')"}, "fare_amount_usd": {"inputFields": [{"namespace": "file://my-local-filesystem", "name": "/data/bronze_daily_bookings.csv", "field": "fare_amount_local"}, {"namespace": "file://my-local-filesystem", "name": "/data/bronze_daily_bookings.csv", "field": "currency_code_raw"}], "transformationDescription": "Calculated by applying exchange rate based on currency code"}, "load_timestamp": {"inputFields": [], "transformationDescription": "Generated using datetime.now()"}}}}}]}